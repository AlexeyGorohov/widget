!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function d(){return u(" ")}function f(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function h(t,e){e=""+e,t.data!==e&&(t.data=e)}function p(t,e,n){t.classList[n?"add":"remove"](e)}let g;function m(t){g=t}!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===n&&o.firstChild?o.insertBefore(s,o.firstChild):o.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}('@import "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css";\n\nmain {\n  background: #eee;\n}\n\n.seating {\n  background-color: var(--yellow);\n}\n\n.seating__col {\n  flex: 1 0 calc(100% / 10);\n  max-width: calc(100% / 10);\n}\n\n.seating__item {\n  transition: .3s ease;\n  cursor: pointer;\n  background-color: var(--yellow);\n}\n\n.seating__item.disabled {\n  cursor: auto;\n  color:white;\n  background-color: var(--red);\n}\n');const $=[],b=[],y=[],_=[],v=Promise.resolve();let x=!1;function k(t){y.push(t)}function w(){const t=new Set;do{for(;$.length;){const t=$.shift();m(t),S(t.$$)}for(;b.length;)b.pop()();for(let e=0;e<y.length;e+=1){const n=y[e];t.has(n)||(n(),t.add(n))}y.length=0}while($.length);for(;_.length;)_.pop()();x=!1}function S(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(k))}const C=new Set;let B;function E(t,e){t&&t.i&&(C.delete(t),t.i(e))}function D(t,e){t.d(1),e.delete(t.key)}function I(t,n,r){const{fragment:c,on_mount:i,on_destroy:a,after_update:l}=t.$$;c.m(n,r),k(()=>{const n=i.map(e).filter(s);a?a.push(...n):o(n),t.$$.on_mount=[]}),l.forEach(k)}function A(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function M(t,e){t.$$.dirty||($.push(t),x||(x=!0,v.then(w)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function N(e,s,r,c,i,a){const l=g;m(e);const u=s.props||{},d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:null};let f=!1;var h;d.ctx=r?r(e,u,(t,n,o=n)=>(d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),f&&M(e,t)),n)):u,d.update(),f=!0,o(d.before_update),d.fragment=c(d.ctx),s.target&&(s.hydrate?d.fragment.l((h=s.target,Array.from(h.childNodes))):d.fragment.c(),s.intro&&E(e.$$.fragment),I(e,s.target,s.anchor),w()),m(l)}class O{$destroy(){A(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const j=[];const T=[...Array(100).keys()].map(t=>({id:t,price:120,disabled:!1}));const L=function(){const{subscribe:e,update:n}=function(e,n=t){let o;const s=[];function c(t){if(r(e,t)&&(e=t,o)){const t=!j.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),j.push(n,e)}if(t){for(let t=0;t<j.length;t+=2)j[t][0](j[t+1]);j.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(r,i=t){const a=[r,i];return s.push(a),1===s.length&&(o=n(c)||t),r(e),()=>{const t=s.indexOf(a);-1!==t&&s.splice(t,1),0===s.length&&(o(),o=null)}}}}(T);return{subscribe:e,toggleSeat:t=>{n(e=>(e[t].disabled=!e[t].disabled,e))}}}();function q(t,e,n){const o=Object.create(t);return o.seat=e[n],o}function P(t,e,n){const o=Object.create(t);return o.item=e[n],o}function z(t){var e,n,o=t.item.id+"";return{c(){e=u(o),n=d()},m(t,o){i(t,e,o),i(t,n,o)},p(t,n){t.selectedSeat&&o!==(o=n.item.id+"")&&h(e,o)},d(t){t&&(a(e),a(n))}}}function F(t,e){var n,o,s,r,g,m=e.seat.id+"";function $(...t){return e.click_handler(e,...t)}return{key:t,first:null,c(){var t,c,i,a;n=l("div"),o=l("div"),s=u(m),r=d(),f(o,"class","seating__item p-2 w-100 text-center border border-succes rounded\n          cursor-pointer"),p(o,"disabled",e.seat.disabled),f(n,"class","seating__col p-1 d-flex"),c="click",i=$,(t=o).addEventListener(c,i,a),g=(()=>t.removeEventListener(c,i,a)),this.first=n},m(t,e){i(t,n,e),c(n,o),c(o,s),c(n,r)},p(t,n){e=n,t.$seating&&m!==(m=e.seat.id+"")&&h(s,m),t.$seating&&p(o,"disabled",e.seat.disabled)},d(t){t&&a(n),g()}}}function G(e){var n,o,s,r,p,g,m,$,b,y=[],_=new Map;let v=e.selectedSeat,x=[];for(let t=0;t<v.length;t+=1)x[t]=z(P(e,v,t));let k=e.$seating;const w=t=>t.seat.id;for(let t=0;t<k.length;t+=1){let n=q(e,k,t),o=w(n);_.set(o,y[t]=F(o,n))}return{c(){n=l("div"),o=u("Цена: "),s=u(e.sum),r=d(),p=l("div"),g=u("Выбранные места: ");for(let t=0;t<x.length;t+=1)x[t].c();m=d(),$=l("section"),b=l("div");for(let t=0;t<y.length;t+=1)y[t].c();f(n,"class","mb-2"),f(p,"class","mb-3"),f(b,"class","d-flex flex-wrap"),f($,"class","section section_seating")},m(t,e){i(t,n,e),c(n,o),c(n,s),i(t,r,e),i(t,p,e),c(p,g);for(let t=0;t<x.length;t+=1)x[t].m(p,null);i(t,m,e),i(t,$,e),c($,b);for(let t=0;t<y.length;t+=1)y[t].m(b,null)},p(t,e){if(t.sum&&h(s,e.sum),t.selectedSeat){let n;for(v=e.selectedSeat,n=0;n<v.length;n+=1){const o=P(e,v,n);x[n]?x[n].p(t,o):(x[n]=z(o),x[n].c(),x[n].m(p,null))}for(;n<x.length;n+=1)x[n].d(1);x.length=v.length}const n=e.$seating;y=function(t,e,n,o,s,r,c,i,a,l,u,d){let f=t.length,h=r.length,p=f;const g={};for(;p--;)g[t[p].key]=p;const m=[],$=new Map,b=new Map;for(p=h;p--;){const t=d(s,r,p),i=n(t);let a=c.get(i);a?o&&a.p(e,t):(a=l(i,t)).c(),$.set(i,m[p]=a),i in g&&b.set(i,Math.abs(p-g[i]))}const y=new Set,_=new Set;function v(t){E(t,1),t.m(i,u),c.set(t.key,t),u=t.first,h--}for(;f&&h;){const e=m[h-1],n=t[f-1],o=e.key,s=n.key;e===n?(u=e.first,f--,h--):$.has(s)?!c.has(o)||y.has(o)?v(e):_.has(s)?f--:b.get(o)>b.get(s)?(_.add(o),v(e)):(y.add(s),f--):(a(n,c),f--)}for(;f--;){const e=t[f];$.has(e.key)||a(e,c)}for(;h;)v(m[h-1]);return m}(y,t,w,1,e,n,_,b,D,F,null,q)},i:t,o:t,d(t){t&&(a(n),a(r),a(p)),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(x,t),t&&(a(m),a($));for(let t=0;t<y.length;t+=1)y[t].d()}}}function H(t,e,n){let o;var s,r;s=L,r=(t=>{n("$seating",o=t)}),t.$$.on_destroy.push(function(t,e){const n=t.subscribe(e);return n.unsubscribe?()=>n.unsubscribe():n}(s,r));let c,i;return t.$$.update=((t={$seating:1,selectedSeat:1})=>{t.$seating&&n("selectedSeat",c=o.filter(t=>!0===t.disabled)),t.selectedSeat&&n("sum",i=c.reduce((t,e)=>t+e.price,0))}),{selectedSeat:c,$seating:o,sum:i,click_handler:({seat:t},e)=>(function(t){const{id:e}=t;L.toggleSeat(e)})(t)}}class J extends O{constructor(t){super(),N(this,t,H,G,r,[])}}function K(e){var n,o,s,r,u=new J({});return{c(){n=l("main"),(o=l("h1")).textContent="Выберите место",s=d(),u.$$.fragment.c(),f(n,"class","p-2")},m(t,e){i(t,n,e),c(n,o),c(n,s),I(u,n,null),r=!0},p:t,i(t){r||(E(u.$$.fragment,t),r=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(C.has(t))return;C.add(t),B.c.push(()=>{C.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}(u.$$.fragment,t),r=!1},d(t){t&&a(n),A(u)}}}function Q(t,e,n){let{CBID:o}=e;return console.log(o),t.$set=(t=>{"CBID"in t&&n("CBID",o=t.CBID)}),{CBID:o}}new class extends O{constructor(t){super(),N(this,t,Q,K,r,["CBID"])}}({target:document.body,props:{CBID:void 0}})}();
//# sourceMappingURL=CBWidget.js.map
